<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JuliUs - ウケジャレイヤーオンライン</title>
    <!-- Tailwind CSSを読み込み -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* フォントや全体的なスタイル調整 */
        body {
            font-family: 'Inter', 'Helvetica Neue', 'Arial', 'Hiragino Kaku Gothic ProN', 'Hiragino Sans', 'Meiryo', sans-serif;
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
</head>
<body class="bg-gray-100 text-gray-800">

    <!-- ヘッダーの読み込み場所 -->
    <div id="header-placeholder"></div>

    <!-- メインコンテンツ -->
    <main class="container mx-auto px-6 py-12">

        <section class="text-center">

        <!-- ヒーローセクション -->
        <section class="text-center">
            <h2 class="text-4xl font-extrabold tracking-tight text-gray-900 sm:text-5xl md:text-6xl">
                JuliUsへようこそ！
            </h2>
            <p class="mt-4 max-w-2xl mx-auto text-xl text-gray-500">
                奥深い戦略ボードゲーム「ウケジャレイヤー」がついにオンライン化！
            </p>
        </section>

        <!-- ゲーム説明セクション -->
        <section class="mt-16 bg-white p-8 rounded-lg shadow-lg">
            <h3 class="text-2xl font-bold mb-6 text-center">ゲームのルール</h3>
            <div class="space-y-8 md:space-y-0 md:grid md:grid-cols-2 md:gap-10">
                <!-- 勝利条件 -->
                <div>
                    <h4 class="text-xl font-semibold mb-2">勝利条件</h4>
                    <p class="text-gray-700">
                        相手が操作できる手を完全になくすことで勝利となります。
                    </p>
                    <p class="mt-2 text-gray-600">
                        最終的には、盤上にある相手の駒すべての上に自分の駒を重ねて「覆い尽くす」ことを目指します。
                    </p>
                </div>

                <!-- 基本操作 -->
                <div>
                    <h4 class="text-xl font-semibold mb-2">基本操作</h4>
                    <p class="text-gray-700">
                        自分のターンでは、以下のいずれかのアクションを行います。
                    </p>
                    <div class="mt-4 space-y-4">
                        <div>
                            <p class="font-bold">召喚 (Summon)</p>
                            <p class="text-gray-600">空いているマスに自分の駒を1つ配置します。各プレイヤー8回まで可能です。</p>
                        </div>
                        <div>
                            <p class="font-bold">移動 (Move)</p>
                            <p class="text-gray-600">自分の駒が一番上にあるマスの駒を、好きな枚数かさねて縦か横に1マス動かします。駒を重ねることが戦略の鍵です。</p>
                        </div>
                        <div>
                            <p class="font-bold">排除 (Eliminate)</p>
                            <p class="text-gray-600">全駒を召喚後、自分の駒が一番上にあるマスから相手の駒を1つ取り除けます。</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- アクションボタンセクション -->
        <section class="mt-16 text-center">
            <h3 class="text-2xl font-bold mb-8">ゲームを始める</h3>
            <div class="flex flex-col sm:flex-row justify-center items-center gap-4">
                <!-- 対局を作成するボタン -->
                <a href="create.html" class="w-full sm:w-auto bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-8 rounded-lg text-lg transition duration-300 ease-in-out transform hover:scale-105">
                    対局を作成する
                </a>
                <!-- 対局に参加するボタン -->
                <a href="join.html" class="w-full sm:w-auto bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-8 rounded-lg text-lg transition duration-300 ease-in-out transform hover:scale-105">
                    対局に参加する
                </a>
                <!-- 対局を観戦するボタン -->
                <a href="spectate.html" class="w-full sm:w-auto bg-gray-500 hover:bg-gray-600 text-white font-bold py-3 px-8 rounded-lg text-lg transition duration-300 ease-in-out transform hover:scale-105">
                    対局を観戦する
                </a>
            </div>
        </section>

    </main>

    <!-- フッター -->
    <footer class="bg-white mt-16">
        <div class="container mx-auto px-6 py-4 text-center text-gray-500">
            <p>&copy; 2025 JuliUs. All rights reserved. Created by Akky.</p>
        </div>
    </footer>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
        // signInWithPopup と GoogleAuthProvider を追加でインポートします
        import { getAuth, onAuthStateChanged, signOut, GoogleAuthProvider, signInWithPopup } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";

        const firebaseConfig = {
            apiKey: "AIzaSyBSjq7McZVw23FZisxX7wpMFrpEdX7wjBo",
            authDomain: "julius-online-a5984.firebaseapp.com",
            databaseURL: "https://julius-online-a5984-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "julius-online-a5984",
            storageBucket: "julius-online-a5984.appspot.com",
            messagingSenderId: "688172535832",
            appId: "1:688172535832:web:ba8cdf48d178b4cdcf336d"
        };

        let app;
        if (!window.firebaseApp) {
            app = initializeApp(firebaseConfig);
            window.firebaseApp = app;
        } else {
            app = window.firebaseApp;
        }

        const auth = getAuth(app);
        const provider = new GoogleAuthProvider(); // ポップアップ用のプロバイダーを定義
        const actionButtons = document.querySelector('.flex.flex-col.sm\\:flex-row');
        const headerPlaceholder = document.getElementById('header-placeholder');

        fetch('header.html')
            .then(response => response.text())
            .then(data => {
                headerPlaceholder.innerHTML = data;
                const authStatusContainer = document.getElementById('header-auth-status');

                onAuthStateChanged(auth, (user) => {
                    // アクションボタンの表示/非表示
                    if (user) {
                        actionButtons.classList.remove('hidden');
                    } else {
                        actionButtons.classList.add('hidden');
                    }

                    // ヘッダーのログイン状態を更新
                    if (user) {
                        // ログイン済みの場合：ユーザー名とログアウトボタンを表示
                        authStatusContainer.innerHTML = `
                            <div class="flex items-center space-x-4">
                                <p class="text-sm">ようこそ、<span class="font-bold">${user.displayName || 'ゲスト'}</span>さん</p>
                                <button id="header-logout-button" class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-lg text-sm transition">
                                    ログアウト
                                </button>
                            </div>
                        `;
                        document.getElementById('header-logout-button').addEventListener('click', () => {
                            signOut(auth).catch(error => console.error('Logout failed', error));
                        });
                    } else {
                        // 未ログインの場合：ログインボタンを表示
                        authStatusContainer.innerHTML = `
                            <button id="header-login-button" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg text-sm transition">
                                ログイン
                            </button>
                        `;
                        // 新しく作成したログインボタンにクリックイベントを追加
                        document.getElementById('header-login-button').addEventListener('click', () => {
                            signInWithPopup(auth, provider)
                                .catch((error) => {
                                    console.error("Login with popup failed", error);
                                });
                        });
                    }
                });
            });
    </script>